.. _developer-manual:

Developer manual
****************

.. toctree::
  :titlesonly:

  reference_sample

Newcomers
=========

If you are new to |NNPZ|, install it :ref:`from sources<install-from-sources>`
first, and follow the :ref:`quickstart` thoroughly. Reading
the full :ref:`user-manual` is recommended before starting to touch the code.
Reading the :ref:`pipeline-description` is a must.

Overview
========

|NNPZ| provides five command line utilities. Their code is under
``NNPZ/python/nnpz/program`` as Python modules. The script is generated by
Elements during the building of the project.

Four of the commands wrap individual components of the pipeline and can
be chained: ``NnpzComputeNeighbors`` -> ``NnpzCorrectPhotometry``
-> ``NnpzComputeWeights`` -> ``NnpzGenerateOutput``.

The fifth, ``nnpz``, is the one used by ``PHZ_Pipeline`` and directly run all stages.

Good practices
==============
|NNPZ| includes a `.editorconfig <https://EditorConfig.org>`_ file,
and a `.clang-format <https://clang.llvm.org/docs/ClangFormat.html>`_ file  specifying
the code style, so make sure you configure your |IDE| or editor to use them.
Most of the most popular ones either support them natively, or via a plugin.

The `Style Guide for Python Code (PEP8) <https://www.python.org/dev/peps/pep-0008/>`_
is a good resource for style, but do not bother too much with some parts of
the specification (specially "Function and Variable Names"), partially because
it was not a concern at first, but mostly to keep the style consistent with Elements.

For working on the code, please follow the `Git Workflow <https://euclid.roe.ac.uk/projects/codeen-users/wiki/Git_workflow>`_
that applies to Euclid projects. New features and non trivial fixes should be
made on their own branch, and when done request a merge via `Gitlab <https://gitlab.euclid-sgs.uk/PF-PHZ/PHZ_NNPZ>`_,
so your changes can be reviewed. Do follow the naming convention of the Git
workflow so `Jenkins <https://codeen.euclid-ec.org/jenkins/>`_ detect the new
branches and perform the builds on the EDEN environment.

Add new tests whenever possible. Specially for fixes, it can be useful to write
the test first, make sure it fails, do the fix and then verify the test passes.

.. warning::

  Remember to update this document if the functionality of |NNPZ| changes.
  You can keep the changes on a separate branch, and request a merge at the
  same time you request a merge for the code.
